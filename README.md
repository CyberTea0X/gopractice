## Стек

 - Язык программирования: Go(golang)
 - База данных: PostgreSQL
 - Деплой зависимостей и самого сервиса: Docker или Docker Compose

## Деплой зависимостей и самого сервиса

 > Примечание: запуск сервиса протестирован только на linux. 
 Инструкции по запуску написаны для линукса.
 Например, можно использовать виртуальную машину ubuntu LTS.
 Однако, сервис можно развернуть или собрать и на другой операционной системе,
 если установить эмулятор bash и требуемые в инструкциях зависимости.

 > Сервис сам создаёт все необходимые таблицы в базе данных.

 > Желательно установить утилиту make. Если её нет, то
 можете просто копировать команды из Makefile, но проще будет поставить.

Далее предполагается что вы изначально в папке репозитория.
### Через docker

Убедитесь что у вас установлен и настроен docker для вашей операционной системы.

Также у вас должен быть доступ к базе данных postgres (возможность создавать таблицы и
т.п. в указанной базе данных).
Либо вы можете запустить свою postgres базу данных командой `make start-db`.

Скопируйте `config_test.toml` как `config.toml` и проведите его настройку
Измените `users.json` если вам это надо

Соберите docker image:

```bash
make docker-build
```

Укажите все необходимые переменные среды в файле .env (смотрите файл [env_example](./env_example).

Теперь вы можете запустить docker контейнер. Например, так:

 > При использовании этой команды сервис будет доступен на локальном порту 8080
 > Это можно изменить при помощи переменной среды `PORT`, переданной в докер контейнер.
 > Либо эту переменную можно просто добавить в .env файл.

```bash
make docker-run
```

### Сборка из исходников и запуск

Вам понадобится [установленный golang](https://go.dev/doc/install).
Потом можно будет его удалить и пользоваться двоичным файлом сервиса.

Сперва убедитесь что у вас запущена база данных postgres в докере, локально,
или на удалённом сервере и у вас есть к ней доступ (вы можете зайти в неё с паролем,
создать таблицу и т.п.).

Скопируйте `config_test.toml` как `config.toml` и проведите его настройку
Измените `users.json` если вам это надо

Способ 1: 

```bash
go run .
```

Способ 2:

```bash
go build -o gopractice
```

Запустите сервис:

```bash
./gopractice
```

Двоичный файл вместе с конфигом можно поместить туда, куда вам нужно, остальное
можно удалить.

## Как работать с сервисом и документация API

Для начала разверните сервис где-нибудь и запишите ip и port, убедитесь, что
у вас есть доступ к этому адресу и порту.

Файл [openapi.html](./docs/openapi.html) можно открыть в браузере. В этом
файле описаны API и примеры запросов.

Файл [openapi.yaml](./docs/openapi.yaml) содержит документацию api в формате
openapi. Если вы не знаете, что это такое, лучше откройте его html версию.

Также можете импортировать файл [openapi.yaml](./docs/openapi.yaml) как API в Postman, после чего
создать на его основе коллекцию. После указания переменной адреса сервиса в коллекции,
вы можете выполнять запросы к сервису. Для большинства переменных postman установит заглушки
вида `\<integer\>`, поэтому их придётся заменить другими данными.
